{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Plant Bioinformatics Vol 3 RNA-Seq Tutorial \u00b6 Goal \u00b6 This tutorial is an online version of an RNA-Seq tutorial developed for Vol. 3 of Plant Bioinformatics. It is an end-to-end RNA-seq analysis using the Kallisto and Sleuth. The tutorial emphasizes reproducibility features of the CyVerse platforms. Tutorial Maintainer(s) \u00b6 Who to contact if this guide needs fixing. You can also email learning@CyVerse.org Maintainer Institution Contact Jason Williams CyVerse / Cold Spring Harbor Laboratory williams@cshl.edu Prerequisites \u00b6 Downloads, access, and services \u00b6 In order to complete this tutorial you will need access to the following services/software Prerequisite Preparation/Notes Link/Download CyVerse account You will need a CyVerse account to complete this exercise CyVerse User Portal Spreadsheet software Software for editing spreadsheet data User provided (e.g. Excel, Google Sheets, or Open Office) Cyberduck (optional) Standalone software for upload/download to Data Store Download Cyberduck Platform(s) \u00b6 We will use the following CyVerse platform(s): Platform Interface Link Platform Tour Discovery Environment and Data Store Web/Point-and-click Discovery Environment Discovery Environment guide Application(s) used \u00b6 Discovery Environment App(s): App name Version Description App link Notes/other links sra-tools prefetch SRA tools version 2.8.10, CyVerse App version 0.1 Utility for downloading data from NCBI Sequence Read Archive sra-tools prefetch app SRA Tools Documentation sra-tools vdb-validate SRA tools version 2.8.10, CyVerse App version 0.1 Utility for validating downloaded data from NCBI Sequence Read Archive sra-tools vdb-validate app SRA Tools Documentation sra-tools fasterq-dump SRA tools version 2.8.10, CyVerse App version 0.1 Convert SRA files to FastQ format sra-tools fasterq-dump app SRA Tools Documentation FastQC 0.11.5 Quality control reports for FastQ files FastQC app FastQC Documentation Kallisto 0.43.1 RNA-Seq quantification by pseudoalignment Kallisto app FastQC Documentation Sleuth 0.30.0 VICE application of RStudio with Sleuth and related R packages Sleuth app FastQC Documentation Input and example data \u00b6 In order to complete this tutorial you will need to have the following inputs prepared Input File(s) Format Preparation/Notes Example Data SRA files (from NCBI Sequence Read Archive) or FastQ files \".sra\", \".fastq\" This tutorial starts with importing data from the SRA. You could also start at Organize files, validate import, and extract to FastQ format CyVerse Data Commons SRA Metadata, custom metadata \".csv\" This tutorial uses metadata provided from the SRA. If using your own FastQ files, you may create and use any metadata you wish. CyVerse Data Commons 2 Sample-data The data for this tutorial comes from Zia et al. 2019 which used RNA-Seq to explore overlap in signaling pathways in Arabidopsis treated with the hormones melatonin and auxin. Although these hormones have similar chemical structures (indoles), the study identified distinct signaling pathways and changes in gene expression. The dataset is available on the SRA under BioProject PRJNA553702. We will attempt to replicate the RNA-Seq portion of this analysis. Zia, S. F., Berkowitz, O., Bedon, F., Whelan, J., Franks, A. E., & Plummer, K. M. (2019). Direct comparison of Arabidopsis gene expression reveals different responses to melatonin versus auxin. BMC Plant Biology. https://doi.org/10.1186/s12870-019-2158-3","title":"Plant Bioinformatics Vol 3 RNA-Seq Tutorial"},{"location":"#plant-bioinformatics-vol-3-rna-seq-tutorial","text":"","title":"Plant Bioinformatics Vol 3 RNA-Seq Tutorial"},{"location":"#goal","text":"This tutorial is an online version of an RNA-Seq tutorial developed for Vol. 3 of Plant Bioinformatics. It is an end-to-end RNA-seq analysis using the Kallisto and Sleuth. The tutorial emphasizes reproducibility features of the CyVerse platforms.","title":"Goal"},{"location":"#tutorial-maintainers","text":"Who to contact if this guide needs fixing. You can also email learning@CyVerse.org Maintainer Institution Contact Jason Williams CyVerse / Cold Spring Harbor Laboratory williams@cshl.edu","title":"Tutorial Maintainer(s)"},{"location":"#prerequisites","text":"","title":"Prerequisites"},{"location":"#downloads-access-and-services","text":"In order to complete this tutorial you will need access to the following services/software Prerequisite Preparation/Notes Link/Download CyVerse account You will need a CyVerse account to complete this exercise CyVerse User Portal Spreadsheet software Software for editing spreadsheet data User provided (e.g. Excel, Google Sheets, or Open Office) Cyberduck (optional) Standalone software for upload/download to Data Store Download Cyberduck","title":"Downloads, access, and services"},{"location":"#platforms","text":"We will use the following CyVerse platform(s): Platform Interface Link Platform Tour Discovery Environment and Data Store Web/Point-and-click Discovery Environment Discovery Environment guide","title":"Platform(s)"},{"location":"#applications-used","text":"Discovery Environment App(s): App name Version Description App link Notes/other links sra-tools prefetch SRA tools version 2.8.10, CyVerse App version 0.1 Utility for downloading data from NCBI Sequence Read Archive sra-tools prefetch app SRA Tools Documentation sra-tools vdb-validate SRA tools version 2.8.10, CyVerse App version 0.1 Utility for validating downloaded data from NCBI Sequence Read Archive sra-tools vdb-validate app SRA Tools Documentation sra-tools fasterq-dump SRA tools version 2.8.10, CyVerse App version 0.1 Convert SRA files to FastQ format sra-tools fasterq-dump app SRA Tools Documentation FastQC 0.11.5 Quality control reports for FastQ files FastQC app FastQC Documentation Kallisto 0.43.1 RNA-Seq quantification by pseudoalignment Kallisto app FastQC Documentation Sleuth 0.30.0 VICE application of RStudio with Sleuth and related R packages Sleuth app FastQC Documentation","title":"Application(s) used"},{"location":"#input-and-example-data","text":"In order to complete this tutorial you will need to have the following inputs prepared Input File(s) Format Preparation/Notes Example Data SRA files (from NCBI Sequence Read Archive) or FastQ files \".sra\", \".fastq\" This tutorial starts with importing data from the SRA. You could also start at Organize files, validate import, and extract to FastQ format CyVerse Data Commons SRA Metadata, custom metadata \".csv\" This tutorial uses metadata provided from the SRA. If using your own FastQ files, you may create and use any metadata you wish. CyVerse Data Commons 2 Sample-data The data for this tutorial comes from Zia et al. 2019 which used RNA-Seq to explore overlap in signaling pathways in Arabidopsis treated with the hormones melatonin and auxin. Although these hormones have similar chemical structures (indoles), the study identified distinct signaling pathways and changes in gene expression. The dataset is available on the SRA under BioProject PRJNA553702. We will attempt to replicate the RNA-Seq portion of this analysis. Zia, S. F., Berkowitz, O., Bedon, F., Whelan, J., Franks, A. E., & Plummer, K. M. (2019). Direct comparison of Arabidopsis gene expression reveals different responses to melatonin versus auxin. BMC Plant Biology. https://doi.org/10.1186/s12870-019-2158-3","title":"Input and example data"},{"location":"step1/","text":"Discovery Environment Login and Setup \u00b6 Description: In this section we will create a folder in the Discovery Environment (DE) and begin organizing a space for our experimental data and analysis results on the Data Store. CyVerse Account Setup \u00b6 Obtain a CyVerse account at CyVerse User Portal . Register with an institutional email address (e.g., .edu or .org) if possible. If you previously have had a CyVerse account, you can also recover or reset your password on this site. After signup, you will need to verify your email address in order to activate your account. Discovery Environment Login and Data Sharing Setup \u00b6 Log in to the Discovery Environment . Click on Data to browse your collection of files and navigate to your home folder (i.e., top folder labeled with your CyVerse username). Click the Folder button to create a new folder for this project (suggested name: rna-seq-tutorial ). Note You should avoid using spaces or special characters (e.g., !@#$%^&) in any folder or file names. 4. Once you have created this folder, you may want to share it with collaborators. To do so, select (checkbox) the rna-seq-tutorial folder in your Data view. Then, click the Share button. 5. (Optional) You can then enter the names (i.e., name, username, email address) of collaborators you wish to share data with. These collaborators must also have a CyVerse account. Once you have found collaborators to share with, you must select the level of access you wish to grant. Tip See more on Data sharing in thr Data Store Guide . More on the Discovery Environment \u00b6 Layout of the Discovery Environment The Discovery Environment is a web-based graphical user interface that allows CyVerse users to manage, share, and annotate data, launch analysis jobs using applications, and log the status and history of analyses. In this expanded view the left sidebar menu: (A) shows several icons: Home presents the default view at login with access to recently used and favorite applications; Data shows a view of the CyVerse Data Store including publicly available (community) data; when logged in you will view your uploaded and shared files and folders. You will also access menu-based data management tools (e.g., upload, folder and file creation, file previews, sharing, search and metadata) in this view. Apps provides view of the application catalogue, as well as tools for modifying and creating new applications and workflows. Analyses provides view of job history, and the status of submitted and running jobs. Job management features include the ability to cancel or relaunch jobs and view detailed job parameters. Cloud Shell provides a limited Linux-based shell interface. Teams allows you to select and manage user groups. Collections allows you to select and manage groupings of applications and resources. Settings allows you to see and change default setting for the platform. Help allows you access to help resources. The Search bar (B) allows you to search across data, applications, and analyses. Additional functions (C) include login and account information, notifications, help, and collections. Learn more in the Discovery Environment Guide .","title":"Step 1"},{"location":"step1/#discovery-environment-login-and-setup","text":"Description: In this section we will create a folder in the Discovery Environment (DE) and begin organizing a space for our experimental data and analysis results on the Data Store.","title":"Discovery Environment Login and Setup"},{"location":"step1/#cyverse-account-setup","text":"Obtain a CyVerse account at CyVerse User Portal . Register with an institutional email address (e.g., .edu or .org) if possible. If you previously have had a CyVerse account, you can also recover or reset your password on this site. After signup, you will need to verify your email address in order to activate your account.","title":"CyVerse Account Setup"},{"location":"step1/#discovery-environment-login-and-data-sharing-setup","text":"Log in to the Discovery Environment . Click on Data to browse your collection of files and navigate to your home folder (i.e., top folder labeled with your CyVerse username). Click the Folder button to create a new folder for this project (suggested name: rna-seq-tutorial ). Note You should avoid using spaces or special characters (e.g., !@#$%^&) in any folder or file names. 4. Once you have created this folder, you may want to share it with collaborators. To do so, select (checkbox) the rna-seq-tutorial folder in your Data view. Then, click the Share button. 5. (Optional) You can then enter the names (i.e., name, username, email address) of collaborators you wish to share data with. These collaborators must also have a CyVerse account. Once you have found collaborators to share with, you must select the level of access you wish to grant. Tip See more on Data sharing in thr Data Store Guide .","title":"Discovery Environment Login and Data Sharing Setup"},{"location":"step1/#more-on-the-discovery-environment","text":"Layout of the Discovery Environment The Discovery Environment is a web-based graphical user interface that allows CyVerse users to manage, share, and annotate data, launch analysis jobs using applications, and log the status and history of analyses. In this expanded view the left sidebar menu: (A) shows several icons: Home presents the default view at login with access to recently used and favorite applications; Data shows a view of the CyVerse Data Store including publicly available (community) data; when logged in you will view your uploaded and shared files and folders. You will also access menu-based data management tools (e.g., upload, folder and file creation, file previews, sharing, search and metadata) in this view. Apps provides view of the application catalogue, as well as tools for modifying and creating new applications and workflows. Analyses provides view of job history, and the status of submitted and running jobs. Job management features include the ability to cancel or relaunch jobs and view detailed job parameters. Cloud Shell provides a limited Linux-based shell interface. Teams allows you to select and manage user groups. Collections allows you to select and manage groupings of applications and resources. Settings allows you to see and change default setting for the platform. Help allows you access to help resources. The Search bar (B) allows you to search across data, applications, and analyses. Additional functions (C) include login and account information, notifications, help, and collections. Learn more in the Discovery Environment Guide .","title":"More on the Discovery Environment"},{"location":"step10/","text":"Evaluate Differential Expression with Sleuth \u00b6 Description: In this final section of the tutorial, we will use the R package Sleuth to visualize our data and perform differential expression analysis. We will summarize the R analysis steps, but the tutorial itself is provided in the form of an RMarkdown notebook. Input Data: Input Description Example Kallisto quantification results (abundances.h5, abundances.tsv, run_info.json for each FastQ file analyzed ) See detailed description below Kallisto outputs Use Sleuth in RStudio App to Calculate and Visualize Results \u00b6 In the Discovery Environment click on the Data icon and navigate to your rna-seq-tutorial tutorial folder and create a folder to store outputs, name the folder sleuth_analysis . In the Apps view, search for and launch the RStudio Sleuth pb app. You can use this direct link: Sleuth app . In Analysis Info you can name this analysis and provide any comments (optional). Under Output folder , navigate to the sleuth_analysis folder created earlier. Your outputs will automatically be placed in this folder; click Next . In Parameters for Notebooks a default folder containing notebook specific to this tutorial will be loaded ( /iplant/home/shared/cyverse_training/tutorials/pbv3/R ) by default. You may change this if you have an alternative notebook. Under Datasets and Data for analysis navigate to the rna-seq-tutorial folder created earlier, go into the folder containing your Kallisto output, and select the Kallisto_quant_output folder. Under Datasets and Study design file navigate to the rna-seq-tutorial folder created earlier, go into the metadata folder and select the experimental design file (i.e., experimental_design.tsv ); click Next . Click Next again to skip Advanced Settings (optional) ; under Review and Launch click Launch Analysis . Click on Analyses view to see the current status of the job; you can also click on the Analyses icon to navigate to this section. When the job has the status Running you will be able to access the RStudio session. There will be a link icon immediately to the left of the analysis name. Click this to open the RStudio session in a new browser tab. Tip Although the job has Running status, it may take a few minutes to access the RStudio session, the amount of is related to the size of the files being transferred into the RStudio environment. ::: Working in RStudio \u00b6 9. In the RStudio session we must modify our RStudio home directory to make it easier to save files. Open the Terminal tab. Paste in the following commands and hit enter: cp -r data/input/* /home/rstudio/ # make sure folder and filenames match your inputs sudo chmod -R 777 /home/rstudio/R sudo chmod -R 777 /home/rstudio/experimental_design.tsv sudo chmod -R 777 /home/rstudio/kallisto_quant_output In the RStudio Files tab, go to the R folder and click sleuth_pb_tutorial.Rmd to open the notebook. Follow the notebook by clicking the green \"play\" button in each section (chunk) of R code. You can follow along with the notebooks explanations and then press play to run each code chunk. The final code chunk will launch the interactive visualizations in the R Shiny application. Rstudio Outline Without replicating the actual code presented in the notebook, here are the major steps presented: (a) Step 1 : The Sleuth library and additional libraries for plotting and retrieving data from Ensembl are loaded. (b) Step 2 : The experimental design file is loaded, and a table is created that maps this metadata with the Kallisto outputs. \u00a9 Step 3 : We use the biomaRt package to load gene names from Ensembl so that we can more descriptively annotate our transcripts. (d) Step 4 : We indicate the variables we want to compare and use the Sleuth functions to create the data model. (e) Step 5 : We do an exploratory visualization of the dataset using PCA plotting. (f) Step 6 : A liner model is created, and the results of the analysis are displayed in an interactive R Shiny application. The R Shiny application will generate tables of results and figures that can be downloaded and further analyzed. Note: The test table available from the R Shiny application contains a complete list of gene names, quantifications, and other statistics. You can download this directly from the R Shiny app. Note Your web browser must have pop-up blocking disabled to view the Shiny application. When you have finished with your RStudio session, return to the Analysis view and select (checkbox) the RStudio analysis. Go to the Analysis view and select Complete and Save Outputs . Any files created during your RStudio analysis will be saved. Note VICE applications (Like this RStudio application) typically have a 48 hour run time on CyVerse. The application will automatically terminate and save outputs at this time. Output/Results Output Description Example Varies In the Sleuth Shiny application you can export tables with your differential testing results and a variety of graphs. NA Description of output and results Sleuth Shiny application allows you to interactively examine and tailor tables of differential testing results as well as graphs of gene expression and other metrics. The application also allows you to export and save these outputs.","title":"Step 10"},{"location":"step10/#evaluate-differential-expression-with-sleuth","text":"Description: In this final section of the tutorial, we will use the R package Sleuth to visualize our data and perform differential expression analysis. We will summarize the R analysis steps, but the tutorial itself is provided in the form of an RMarkdown notebook. Input Data: Input Description Example Kallisto quantification results (abundances.h5, abundances.tsv, run_info.json for each FastQ file analyzed ) See detailed description below Kallisto outputs","title":"Evaluate Differential Expression with Sleuth"},{"location":"step10/#use-sleuth-in-rstudio-app-to-calculate-and-visualize-results","text":"In the Discovery Environment click on the Data icon and navigate to your rna-seq-tutorial tutorial folder and create a folder to store outputs, name the folder sleuth_analysis . In the Apps view, search for and launch the RStudio Sleuth pb app. You can use this direct link: Sleuth app . In Analysis Info you can name this analysis and provide any comments (optional). Under Output folder , navigate to the sleuth_analysis folder created earlier. Your outputs will automatically be placed in this folder; click Next . In Parameters for Notebooks a default folder containing notebook specific to this tutorial will be loaded ( /iplant/home/shared/cyverse_training/tutorials/pbv3/R ) by default. You may change this if you have an alternative notebook. Under Datasets and Data for analysis navigate to the rna-seq-tutorial folder created earlier, go into the folder containing your Kallisto output, and select the Kallisto_quant_output folder. Under Datasets and Study design file navigate to the rna-seq-tutorial folder created earlier, go into the metadata folder and select the experimental design file (i.e., experimental_design.tsv ); click Next . Click Next again to skip Advanced Settings (optional) ; under Review and Launch click Launch Analysis . Click on Analyses view to see the current status of the job; you can also click on the Analyses icon to navigate to this section. When the job has the status Running you will be able to access the RStudio session. There will be a link icon immediately to the left of the analysis name. Click this to open the RStudio session in a new browser tab. Tip Although the job has Running status, it may take a few minutes to access the RStudio session, the amount of is related to the size of the files being transferred into the RStudio environment. :::","title":"Use Sleuth in RStudio App to Calculate and Visualize Results"},{"location":"step10/#working-in-rstudio","text":"9. In the RStudio session we must modify our RStudio home directory to make it easier to save files. Open the Terminal tab. Paste in the following commands and hit enter: cp -r data/input/* /home/rstudio/ # make sure folder and filenames match your inputs sudo chmod -R 777 /home/rstudio/R sudo chmod -R 777 /home/rstudio/experimental_design.tsv sudo chmod -R 777 /home/rstudio/kallisto_quant_output In the RStudio Files tab, go to the R folder and click sleuth_pb_tutorial.Rmd to open the notebook. Follow the notebook by clicking the green \"play\" button in each section (chunk) of R code. You can follow along with the notebooks explanations and then press play to run each code chunk. The final code chunk will launch the interactive visualizations in the R Shiny application. Rstudio Outline Without replicating the actual code presented in the notebook, here are the major steps presented: (a) Step 1 : The Sleuth library and additional libraries for plotting and retrieving data from Ensembl are loaded. (b) Step 2 : The experimental design file is loaded, and a table is created that maps this metadata with the Kallisto outputs. \u00a9 Step 3 : We use the biomaRt package to load gene names from Ensembl so that we can more descriptively annotate our transcripts. (d) Step 4 : We indicate the variables we want to compare and use the Sleuth functions to create the data model. (e) Step 5 : We do an exploratory visualization of the dataset using PCA plotting. (f) Step 6 : A liner model is created, and the results of the analysis are displayed in an interactive R Shiny application. The R Shiny application will generate tables of results and figures that can be downloaded and further analyzed. Note: The test table available from the R Shiny application contains a complete list of gene names, quantifications, and other statistics. You can download this directly from the R Shiny app. Note Your web browser must have pop-up blocking disabled to view the Shiny application. When you have finished with your RStudio session, return to the Analysis view and select (checkbox) the RStudio analysis. Go to the Analysis view and select Complete and Save Outputs . Any files created during your RStudio analysis will be saved. Note VICE applications (Like this RStudio application) typically have a 48 hour run time on CyVerse. The application will automatically terminate and save outputs at this time. Output/Results Output Description Example Varies In the Sleuth Shiny application you can export tables with your differential testing results and a variety of graphs. NA Description of output and results Sleuth Shiny application allows you to interactively examine and tailor tables of differential testing results as well as graphs of gene expression and other metrics. The application also allows you to export and save these outputs.","title":"Working in RStudio"},{"location":"step11/","text":"Conclusion \u00b6 In this tutorial, we have demonstrated some key features of CyVerse that enable reproducible science at scale. Key functionality areas included: 1) Data upload : Data can be imported and uploaded to the CyVerse Data Store. Our tutorial dataset and analyses total 80 GB of disk space. CyVerse supports terabyte-scale datasets for active analysis with appropriate justification and documentation. 2) Data sharing : These datasets can be shared with fine-grained permissions to other CyVerse users (by username) nearly instantaneously. 3) Metadata : Metadata can be applied to files (either following a template, or by designing a spreadsheet of arbitrary attributes). Once applied, these metadata can be used to search rapidly (via elasticsearch). The Data Store documentation also details how metadata can be directly edited in the Discovery Environment (or by command line through the iCommands interface), and how filters and other features can be used to automate the organization of your files. 4) Reproducible analyses : Software tools used in the Discovery Environment are containerized (Docker) versions of open source software, making it possible to select the desired versions of software and reproduce previous analyses. The DE's analyses functions keep detailed histories of analyses and parameters. 5) Interactive analyses : Through the DE's VICE platform, interactive sessions such as RStudio and R Shiny are used to directly interact with and analyze data. 6) Computational capacity : Although not directly highlighted, all applications make use of the underlying CyVerse compute infrastructure. Additionally, some applications in the DE catalog directly make use of XSEDE supercomputing resources. Taken together, these features provide a high level of functionality that is tailor-made to support data-intensive research and collaboration, all in one place.","title":"Conclusion"},{"location":"step11/#conclusion","text":"In this tutorial, we have demonstrated some key features of CyVerse that enable reproducible science at scale. Key functionality areas included: 1) Data upload : Data can be imported and uploaded to the CyVerse Data Store. Our tutorial dataset and analyses total 80 GB of disk space. CyVerse supports terabyte-scale datasets for active analysis with appropriate justification and documentation. 2) Data sharing : These datasets can be shared with fine-grained permissions to other CyVerse users (by username) nearly instantaneously. 3) Metadata : Metadata can be applied to files (either following a template, or by designing a spreadsheet of arbitrary attributes). Once applied, these metadata can be used to search rapidly (via elasticsearch). The Data Store documentation also details how metadata can be directly edited in the Discovery Environment (or by command line through the iCommands interface), and how filters and other features can be used to automate the organization of your files. 4) Reproducible analyses : Software tools used in the Discovery Environment are containerized (Docker) versions of open source software, making it possible to select the desired versions of software and reproduce previous analyses. The DE's analyses functions keep detailed histories of analyses and parameters. 5) Interactive analyses : Through the DE's VICE platform, interactive sessions such as RStudio and R Shiny are used to directly interact with and analyze data. 6) Computational capacity : Although not directly highlighted, all applications make use of the underlying CyVerse compute infrastructure. Additionally, some applications in the DE catalog directly make use of XSEDE supercomputing resources. Taken together, these features provide a high level of functionality that is tailor-made to support data-intensive research and collaboration, all in one place.","title":"Conclusion"},{"location":"step2/","text":"Obtain Accession Numbers and Metadata from the SRA \u00b6 Description: In this section, we will describe how to import data from the NCBI Sequence Read Archive (SRA). The example dataset is available at the SRA under the accession PRJNA553702. It is not possible to directly download sequencing files from the SRA. Instead, we must obtain the accessions for the individual sequencing files and use the 'sra-tools' software to download those files. Get SRA Accession Metadata \u00b6 Go to the SRA . Enter the BioProject accession ' PRJNA553702 ' in the search bar and press Search . This search should return 12 entries which are individual sequence files associated with this experiment. Click on any of the results (e.g., GSM3936272: 100\u00b5M MEL rep3; Arabidopsis thaliana; RNA-Seq ). This will lead to a page with a detailed description of the experiment. Under the Study heading, find the link to All runs and click this to access the SRA Run Selector. (Direct link: SRP214076 ) Under the Select heading, there are two downloads (simple text files) available for download. Click on Metadata and Accession list to download both files. The metadata file will be called SraRunTable.txt and the accession list will be called SRR_Acc_List.txt . Note All metadata and accession lists from the SRA will have the same file names. Be sure to rename or carefully organize these files if you will be downloading other SRA data. Output/Results Output Description Example SraRunTable.txt Metadata from the SRA SraRunTable SRR_Acc_List.txt Accession list from the SRA SRR_Acc_List Description of output and results The SraRunTable.txt will be used to label our files using the Data Store\\'s metadata capabilities. We will use the SRR_Acc_List.txt as input for importing files from the SRA.","title":"Step 2"},{"location":"step2/#obtain-accession-numbers-and-metadata-from-the-sra","text":"Description: In this section, we will describe how to import data from the NCBI Sequence Read Archive (SRA). The example dataset is available at the SRA under the accession PRJNA553702. It is not possible to directly download sequencing files from the SRA. Instead, we must obtain the accessions for the individual sequencing files and use the 'sra-tools' software to download those files.","title":"Obtain Accession Numbers and Metadata from the SRA"},{"location":"step2/#get-sra-accession-metadata","text":"Go to the SRA . Enter the BioProject accession ' PRJNA553702 ' in the search bar and press Search . This search should return 12 entries which are individual sequence files associated with this experiment. Click on any of the results (e.g., GSM3936272: 100\u00b5M MEL rep3; Arabidopsis thaliana; RNA-Seq ). This will lead to a page with a detailed description of the experiment. Under the Study heading, find the link to All runs and click this to access the SRA Run Selector. (Direct link: SRP214076 ) Under the Select heading, there are two downloads (simple text files) available for download. Click on Metadata and Accession list to download both files. The metadata file will be called SraRunTable.txt and the accession list will be called SRR_Acc_List.txt . Note All metadata and accession lists from the SRA will have the same file names. Be sure to rename or carefully organize these files if you will be downloading other SRA data. Output/Results Output Description Example SraRunTable.txt Metadata from the SRA SraRunTable SRR_Acc_List.txt Accession list from the SRA SRR_Acc_List Description of output and results The SraRunTable.txt will be used to label our files using the Data Store\\'s metadata capabilities. We will use the SRR_Acc_List.txt as input for importing files from the SRA.","title":"Get SRA Accession Metadata"},{"location":"step3/","text":"Upload Files to the Data Store \u00b6 Description: We upload the metadata and accession list from SRA into our project folder on the Data Store. Upload Metadata to Data Store \u00b6 We will upload the metadata and accession files to the Data Store. The metadata file is a CSV file organized as a spreadsheet. In the Discovery Environment Data view, navigate to rna-seq-tutorial folder you previously created; once inside this folder click the Upload button, then select Browse Local . Browse your local computer to select the accession list downloaded from the SRA (i.e., SRR_Acc_List.txt ). Upload the file. Note You will get a notification when upload is completed. You may need to refresh your browser to see the uploaded file. 3. To organize this and other uploads, click the Folder button to create a folder (suggested name: metadata ) inside the rna-seq-tutorial folder. Select (checkbox) the uploaded file (i.e., SRR_Acc_List.txt ) and click the More Actions button; choose Move and then use the Browse button to select the created metadata folder as your destination to move these files to. Click Move to complete this action. You may need to refresh your browser to see changes.","title":"Step 3"},{"location":"step3/#upload-files-to-the-data-store","text":"Description: We upload the metadata and accession list from SRA into our project folder on the Data Store.","title":"Upload Files to the Data Store"},{"location":"step3/#upload-metadata-to-data-store","text":"We will upload the metadata and accession files to the Data Store. The metadata file is a CSV file organized as a spreadsheet. In the Discovery Environment Data view, navigate to rna-seq-tutorial folder you previously created; once inside this folder click the Upload button, then select Browse Local . Browse your local computer to select the accession list downloaded from the SRA (i.e., SRR_Acc_List.txt ). Upload the file. Note You will get a notification when upload is completed. You may need to refresh your browser to see the uploaded file. 3. To organize this and other uploads, click the Folder button to create a folder (suggested name: metadata ) inside the rna-seq-tutorial folder. Select (checkbox) the uploaded file (i.e., SRR_Acc_List.txt ) and click the More Actions button; choose Move and then use the Browse button to select the created metadata folder as your destination to move these files to. Click Move to complete this action. You may need to refresh your browser to see changes.","title":"Upload Metadata to Data Store"},{"location":"step4/","text":"Import Files from SRA with the SRA Toolkit \u00b6 Description: Now that we have a list of accessions, we can use our first application. The sra-tools prefetch app will allow us to import data from the SRA. All of the applications we will be using in the Discovery Environment have been collected together. You may access them by going to the Collections icon in the Discovery Environment. Select the All Collections view and scroll to find the Plant Bioinformatics Vol. 3 Tutorial collection. You may also search for any application by name in the Apps catalogue. Input Data: Input Description Example SRR_Acc_List.txt Accession list from the SRA SRR_Acc_List Use 'sra-tools prefetch' App to Import SRA Data \u00b6 In the , go to Apps and search for sra-tools prefetch . You can use this direct link: sra-tools prefetch app Note All applications used in this tutorial are collected in the Plant Bioinformatics Vol. 3 Tutorial collection - See Collections in the Discovery Environment. In Analysis Info you can name this analysis and provide any comments (optional). Under Output folder , navigate to the rna-seq-tutorial folder created earlier. Your outputs will automatically be placed in this folder); click Next . Tip For future analyses, from the Settings icon in the Discovery Environment under Default analysis output folder you can change the default setting for your outputs. This can be useful when you will be doing several analyses and you want them to go to a folder other than your analyses folder (the default setting). In Parameters under Accession list browse to your rna-seq-tutorial folder and enter the metadata folder; select SRR_Acc_List.txt as input; click Next . In Advanced Settings (optional) , each application in the Discovery Environment has a 'Resource Requirements' option. These are some minimal computational resources that you can choose for the application. When the Discovery Environment launches an analysis job, it may be run on computing hardware of various capabilities (according to what \"nodes\" are available to accept the job). App developers may have set minimums here but you may choose to make adjustments. If you don't know which minimums to choose, you can ignore these options. If you do run into errors, you can contact CyVerse support. Also contact support if the resources you need for an app do not appear in the list of options; CyVerse can increase these minimums. We will not make any changes; click Next . In Review and Launch , click Launch Analysis to begin the analysis job. You will get notification(s) in the Discovery Environment about the status of the job, including an email (by default preferences settings) when the job is complete. Click on Analyses view to see the current status of the job; you can also click on the Analyses icon to navigate to this section. When the job is complete, you can click on the folder icon next to the analyses name to browse the results. You may need to Refresh to see the current job status. This job will vary on connection speed between the CyVerse servers and NCBI. This job is estimated to take about 15-30 minutes. When the job has status Completed, navigate to the output. The resulting output will be 12 folders (one for each accession), each containing a single SRA file (e.g., SRR9666131.sra, SRR9666132.sra ... ). There will also be a logs folder containing output logs from the CyVerse Discovery Environment analysis. Output/Results Output Description Example SRA files (SRR9666131.sra, SRR9666132.sra ...) These are sequence data in the SRA format SRA files Description of output and results The imported SRA files should be validated for their integrity - these are large files and we want to make sure the data has not be corrupted. We will do this integrity check in the next step.","title":"Step 4"},{"location":"step4/#import-files-from-sra-with-the-sra-toolkit","text":"Description: Now that we have a list of accessions, we can use our first application. The sra-tools prefetch app will allow us to import data from the SRA. All of the applications we will be using in the Discovery Environment have been collected together. You may access them by going to the Collections icon in the Discovery Environment. Select the All Collections view and scroll to find the Plant Bioinformatics Vol. 3 Tutorial collection. You may also search for any application by name in the Apps catalogue. Input Data: Input Description Example SRR_Acc_List.txt Accession list from the SRA SRR_Acc_List","title":"Import Files from SRA with the SRA Toolkit"},{"location":"step4/#use-sra-tools-prefetch-app-to-import-sra-data","text":"In the , go to Apps and search for sra-tools prefetch . You can use this direct link: sra-tools prefetch app Note All applications used in this tutorial are collected in the Plant Bioinformatics Vol. 3 Tutorial collection - See Collections in the Discovery Environment. In Analysis Info you can name this analysis and provide any comments (optional). Under Output folder , navigate to the rna-seq-tutorial folder created earlier. Your outputs will automatically be placed in this folder); click Next . Tip For future analyses, from the Settings icon in the Discovery Environment under Default analysis output folder you can change the default setting for your outputs. This can be useful when you will be doing several analyses and you want them to go to a folder other than your analyses folder (the default setting). In Parameters under Accession list browse to your rna-seq-tutorial folder and enter the metadata folder; select SRR_Acc_List.txt as input; click Next . In Advanced Settings (optional) , each application in the Discovery Environment has a 'Resource Requirements' option. These are some minimal computational resources that you can choose for the application. When the Discovery Environment launches an analysis job, it may be run on computing hardware of various capabilities (according to what \"nodes\" are available to accept the job). App developers may have set minimums here but you may choose to make adjustments. If you don't know which minimums to choose, you can ignore these options. If you do run into errors, you can contact CyVerse support. Also contact support if the resources you need for an app do not appear in the list of options; CyVerse can increase these minimums. We will not make any changes; click Next . In Review and Launch , click Launch Analysis to begin the analysis job. You will get notification(s) in the Discovery Environment about the status of the job, including an email (by default preferences settings) when the job is complete. Click on Analyses view to see the current status of the job; you can also click on the Analyses icon to navigate to this section. When the job is complete, you can click on the folder icon next to the analyses name to browse the results. You may need to Refresh to see the current job status. This job will vary on connection speed between the CyVerse servers and NCBI. This job is estimated to take about 15-30 minutes. When the job has status Completed, navigate to the output. The resulting output will be 12 folders (one for each accession), each containing a single SRA file (e.g., SRR9666131.sra, SRR9666132.sra ... ). There will also be a logs folder containing output logs from the CyVerse Discovery Environment analysis. Output/Results Output Description Example SRA files (SRR9666131.sra, SRR9666132.sra ...) These are sequence data in the SRA format SRA files Description of output and results The imported SRA files should be validated for their integrity - these are large files and we want to make sure the data has not be corrupted. We will do this integrity check in the next step.","title":"Use 'sra-tools prefetch' App to Import SRA Data"},{"location":"step5/","text":"Organize Files, Validate Import, and Extract to FastQ Format \u00b6 Description: At this point, we will put all of the files imported from the SRA into a single location. We will verify the integrity of the files and then extract and convert them from the SRA format into the FastQ format. Input Data: Input Description Example SRA files (SRR9666131.sra, SRR9666132.sra ...) These are sequence data in the SRA format SRA files Organize Files \u00b6 In the Discovey Environment click on the Data icon and navigate to your rna-seq-tutorial folder. Click on the Folder button create a new folder: imported_sra . Navigate to the output of the sra-tools prefetch analysis completed in the previous step. You can go the Analyses section of the Discovery Environment and click the folder icon next to the analyses name to navigate to this output. Select (checkbox) all 12 of the SRA folders (e.g., SRR9666131, SRR9666132, ...) and the folder of logs from this analysis; click the More Actions button and choose Move . Browse to the imported_sra folder created inside your tutorial folder ( rna-seq-tutorial ). Click Move to complete this action. It may take a few minutes to complete this move. You may need to refresh your browser to see changes. Validate SRA Files \u00b6 Before extracting these files, we can do a check here to verify the integrity of our import from the SRA. In the Discovery Environment click on the Data icon and navigate to your rna-seq-tutorial tutorial folder and create a folder to store outputs, name the folder sra_validation . In the Apps view, search for and launch the sra-tools vdb-validate app . In Analysis Info you can name this analysis and provide any comments (optional). Under Output folder , navigate to the sra_validation folder created earlier. Your outputs will automatically be placed in this folder; click Next . In Parameters under SRA Files (Input) browse to the imported_sra folder (created in step 2). Open an individual folder (e.g., \"SRR966613\") and select the \".sra\" file to add it; repeat for each of the 12 folders until you have added all 12 '.sra' files (i.e. SRR9666131.sra, SRR9666131.sra...); click Next . Click Next again to skip Advanced Settings (optional) ; under Review and Launch click Launch Analysis . Click on Analyses view to see the current status of the job; you can also click on the Analyses icon to navigate to this section. When the job is complete, you can click on the folder icon next to the analyses name to browse the results. You may need to Refresh to see the current job status. This job is estimated to take about 5-10 minutes. When the job has status Completed , navigate to the output. The output will be a text file ( vdb-validation.txt ). This is a report on a series of file checks (including checksums -- an algorithmically generated signature that confirms the file's integrity). A sample output is shown below with 'ok' indications for each test. A similar set of 8 lines should appear in the file for each of the verified SRA files. Note Sample Output : 2020-10-06T22:04:41 vdb-validate.2.10.8 info: Database 'SRR9666131.sra' metadata: md5 ok 2020-10-06T22:04:41 vdb-validate.2.10.8 info: Table 'SEQUENCE' metadata: md5 ok 2020-10-06T22:04:41 vdb-validate.2.10.8 info: Column 'ALTREAD': checksums ok 2020-10-06T22:04:42 vdb-validate.2.10.8 info: Column 'QUALITY': checksums ok 2020-10-06T22:04:43 vdb-validate.2.10.8 info: Column 'READ': checksums ok 2020-10-06T22:04:43 vdb-validate.2.10.8 info: Column 'READ_LEN': checksums ok 2020-10-06T22:04:44 vdb-validate.2.10.8 info: Column 'READ_START': checksums ok 2020-10-06T22:04:44 vdb-validate.2.10.8 info: Column 'SPOT_GROUP': checksums ok Convert SRA Files to FastQ Format \u00b6 In the Discovery Environment click on the Data icon and navigate to your rna-seq-tutorial folder and create a folder to store outputs, name the folder fastq_files . In the Apps view, search for and launch the sra-tools fasterq-dump app. In Analysis Info you can name this analysis and provide any comments (optional). Under Output folder , navigate to the fastq_files folder created earlier. Your outputs will automatically be placed in this folder; click Next . In Parameters under SRA Files (Input) browse to the imported_sra folder (created in step 3) and open an individual folder (e.g., \"SRR966613\") and select the '.sra' file to add it; repeat for each of the 12 folders until you have added all 12 '.sra' files (i.e. SRR9666131.sra, SRR9666131.sra...); click Next . Click Next again to skip Advanced Settings (optional) ; under Review and Launch click Launch Analysis . Click on Analyses view to see the current status of the job; you can also click on the Analyses icon to navigate to this section. When the job is complete, you can click on the folder icon next to the analyses name to browse the results. You may need to Refresh to see the current job status. This job is expected to take 30-40 minutes. When the job has status Completed , navigate to the output. The expected output will be 12 FASTQ formatted files (e.g., SRR9666131.sra.fastq, SRR9666132.sra.fastq...). Since the SRA files are already maintained on NCBI, you can safely delete the original SRA files. While this deletion is not mandatory, it is a responsible use of public infrastructure to remove large unneeded files. Browse to the rna-seq-tutorial folder and select the imported_sra folder. Click the More Actions button and choose Move to Trash . Clicking your username in the Data view, choose Trash . Select the file you wish to delete and click the Trash button and then select Delete to permanently delete those files. Output/Results Output Description Example FastQ files (e.g. SRR9666131.sra.fastq,SRR9666132.sra.fastq...) Sequencing data in FastQ format [SRA FastQ Files]( https://datacommons.cyverse.org/browse/iplant/home/shared/cyverse_training/tutorials/pbv3/rna-seq-tutorial/fastq_files Description of output and results In this section we have validated the imported SRA files and transformed them into the FastQ format, the input for a variety of sequencing-based analyses.","title":"Step 5"},{"location":"step5/#organize-files-validate-import-and-extract-to-fastq-format","text":"Description: At this point, we will put all of the files imported from the SRA into a single location. We will verify the integrity of the files and then extract and convert them from the SRA format into the FastQ format. Input Data: Input Description Example SRA files (SRR9666131.sra, SRR9666132.sra ...) These are sequence data in the SRA format SRA files","title":"Organize Files, Validate Import, and Extract to FastQ Format"},{"location":"step5/#organize-files","text":"In the Discovey Environment click on the Data icon and navigate to your rna-seq-tutorial folder. Click on the Folder button create a new folder: imported_sra . Navigate to the output of the sra-tools prefetch analysis completed in the previous step. You can go the Analyses section of the Discovery Environment and click the folder icon next to the analyses name to navigate to this output. Select (checkbox) all 12 of the SRA folders (e.g., SRR9666131, SRR9666132, ...) and the folder of logs from this analysis; click the More Actions button and choose Move . Browse to the imported_sra folder created inside your tutorial folder ( rna-seq-tutorial ). Click Move to complete this action. It may take a few minutes to complete this move. You may need to refresh your browser to see changes.","title":"Organize Files"},{"location":"step5/#validate-sra-files","text":"Before extracting these files, we can do a check here to verify the integrity of our import from the SRA. In the Discovery Environment click on the Data icon and navigate to your rna-seq-tutorial tutorial folder and create a folder to store outputs, name the folder sra_validation . In the Apps view, search for and launch the sra-tools vdb-validate app . In Analysis Info you can name this analysis and provide any comments (optional). Under Output folder , navigate to the sra_validation folder created earlier. Your outputs will automatically be placed in this folder; click Next . In Parameters under SRA Files (Input) browse to the imported_sra folder (created in step 2). Open an individual folder (e.g., \"SRR966613\") and select the \".sra\" file to add it; repeat for each of the 12 folders until you have added all 12 '.sra' files (i.e. SRR9666131.sra, SRR9666131.sra...); click Next . Click Next again to skip Advanced Settings (optional) ; under Review and Launch click Launch Analysis . Click on Analyses view to see the current status of the job; you can also click on the Analyses icon to navigate to this section. When the job is complete, you can click on the folder icon next to the analyses name to browse the results. You may need to Refresh to see the current job status. This job is estimated to take about 5-10 minutes. When the job has status Completed , navigate to the output. The output will be a text file ( vdb-validation.txt ). This is a report on a series of file checks (including checksums -- an algorithmically generated signature that confirms the file's integrity). A sample output is shown below with 'ok' indications for each test. A similar set of 8 lines should appear in the file for each of the verified SRA files. Note Sample Output : 2020-10-06T22:04:41 vdb-validate.2.10.8 info: Database 'SRR9666131.sra' metadata: md5 ok 2020-10-06T22:04:41 vdb-validate.2.10.8 info: Table 'SEQUENCE' metadata: md5 ok 2020-10-06T22:04:41 vdb-validate.2.10.8 info: Column 'ALTREAD': checksums ok 2020-10-06T22:04:42 vdb-validate.2.10.8 info: Column 'QUALITY': checksums ok 2020-10-06T22:04:43 vdb-validate.2.10.8 info: Column 'READ': checksums ok 2020-10-06T22:04:43 vdb-validate.2.10.8 info: Column 'READ_LEN': checksums ok 2020-10-06T22:04:44 vdb-validate.2.10.8 info: Column 'READ_START': checksums ok 2020-10-06T22:04:44 vdb-validate.2.10.8 info: Column 'SPOT_GROUP': checksums ok","title":"Validate SRA Files"},{"location":"step5/#convert-sra-files-to-fastq-format","text":"In the Discovery Environment click on the Data icon and navigate to your rna-seq-tutorial folder and create a folder to store outputs, name the folder fastq_files . In the Apps view, search for and launch the sra-tools fasterq-dump app. In Analysis Info you can name this analysis and provide any comments (optional). Under Output folder , navigate to the fastq_files folder created earlier. Your outputs will automatically be placed in this folder; click Next . In Parameters under SRA Files (Input) browse to the imported_sra folder (created in step 3) and open an individual folder (e.g., \"SRR966613\") and select the '.sra' file to add it; repeat for each of the 12 folders until you have added all 12 '.sra' files (i.e. SRR9666131.sra, SRR9666131.sra...); click Next . Click Next again to skip Advanced Settings (optional) ; under Review and Launch click Launch Analysis . Click on Analyses view to see the current status of the job; you can also click on the Analyses icon to navigate to this section. When the job is complete, you can click on the folder icon next to the analyses name to browse the results. You may need to Refresh to see the current job status. This job is expected to take 30-40 minutes. When the job has status Completed , navigate to the output. The expected output will be 12 FASTQ formatted files (e.g., SRR9666131.sra.fastq, SRR9666132.sra.fastq...). Since the SRA files are already maintained on NCBI, you can safely delete the original SRA files. While this deletion is not mandatory, it is a responsible use of public infrastructure to remove large unneeded files. Browse to the rna-seq-tutorial folder and select the imported_sra folder. Click the More Actions button and choose Move to Trash . Clicking your username in the Data view, choose Trash . Select the file you wish to delete and click the Trash button and then select Delete to permanently delete those files. Output/Results Output Description Example FastQ files (e.g. SRR9666131.sra.fastq,SRR9666132.sra.fastq...) Sequencing data in FastQ format [SRA FastQ Files]( https://datacommons.cyverse.org/browse/iplant/home/shared/cyverse_training/tutorials/pbv3/rna-seq-tutorial/fastq_files Description of output and results In this section we have validated the imported SRA files and transformed them into the FastQ format, the input for a variety of sequencing-based analyses.","title":"Convert SRA Files to FastQ Format"},{"location":"step6/","text":"Apply Metadata to FastQ Files \u00b6 Description: Here we make use of the Data Store's ability to tag files with metadata. Many of these metadata descriptions will be required for submission of data to a repository prior to publication. We will modify the previously downloaded ' SraRunTable.txt ' on our local computer in a spreadsheet program and then upload to the Discovery Environment and link these descriptions to the files. This process of metadata application can be applied to any dataset in the Data Store and is a recommended practice. Tip If you were using this tutorial with your own data, uploading your FastQ files and continuing from this section would be a recommended starting point. See the Data Store Guide for more information about uploading files to the Discovery Environment. Input Data: Input Description Example FastQ files (e.g. SRR9666131.sra.fastq,SRR9666132.sra.fastq...) Sequencing data in FastQ format SRA FastQ Files Apply Metadata \u00b6 In a spreadsheet program (e.g., Excel), open the SraRunTable.txt file on your local computer. Tip Renaming the file with a '.csv' extension before opening the file may make it easier for your spreadsheet program to properly interpret. To the spreadsheet, add a new first column (left-most). Name this column \" file .\" At this point, sort the spreadsheet by run (ascending). This will make it easier in the subsequent steps when file names will likely be alphanumerically sorted. In the file column we will list the path in the Data Store for each FASTQ file as corresponds to its accession in the Run column. (e.g., /iplant/home/ USERNAME /rna-seq-tutorial/fastq_files/ SRR9666132.sra.fastq). In the Data view, clicking the three dots next to any file/folder icon reveals a function menu which includes an option to Copy Path . Note Your first two columns should be similar to the below (with your username replacing username below): File Run /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666131.sra.fastq SRR9666131 /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666132.sra.fastq SRR9666132 /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666133.sra.fastq SRR9666133 /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666134.sra.fastq SRR9666134 /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666135.sra.fastq SRR9666135 /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666136.sra.fastq SRR9666136 /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666137.sra.fastq SRR9666137 /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666138.sra.fastq SRR9666138 /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666139.sra.fastq SRR9666139 /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666140.sra.fastq SRR9666140 /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666141.sra.fastq SRR9666141 /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666142.sra.fastq SRR9666142 5. (Optional) At this point, you can add any desired additional columns with any metadata you want to add. For our tutorial this is not necessary. 6. Save this file as fastq_file_metadata.csv on your local computer. 7. In the Discovery Environment Data view, navigate to the metadata folder in your rna-seq-tutorial folder. Open the folder and then click the Upload button, then select Browse Local . 8. Browse your local computer to select the fastq_file_metadata.csv ; upload the file. You will get a notification when upload is completed. You may need to refresh your browser to see the uploaded file. 9. In the Data view, navigate to your rna-seq-tutorial folder and select (checkbox) the fastq_files folder. 10. Click the More Actions button and select Apply Bulk Metadata . Browse to and select the fastq_file_metadata.csv file in the metadata folder. Click Done to complete this action. You will get a notification when the metadata has been applied successfully. 11. To view the metadata, navigate to the fastq_files folder and select (checkbox) any individual FASTQ file. Click the More Actions button and select Metadata . You will then see the applied metadata. You can build custom search queries on any of these attributes (column names in your original spreadsheet) and the values (the entries for these columns). See Data Store Guide for more information about advanced search queries and smart folders. Output/Results Output Description Example fastq_file_metadata.csv A CSV file containing metadata labels for the FastQ files FastQ metadata Description of output and results With metadata applied, this files are now more easy to search and organize. These metadata properties will also be of use in data submission to repositories like SRA.","title":"Step 6"},{"location":"step6/#apply-metadata-to-fastq-files","text":"Description: Here we make use of the Data Store's ability to tag files with metadata. Many of these metadata descriptions will be required for submission of data to a repository prior to publication. We will modify the previously downloaded ' SraRunTable.txt ' on our local computer in a spreadsheet program and then upload to the Discovery Environment and link these descriptions to the files. This process of metadata application can be applied to any dataset in the Data Store and is a recommended practice. Tip If you were using this tutorial with your own data, uploading your FastQ files and continuing from this section would be a recommended starting point. See the Data Store Guide for more information about uploading files to the Discovery Environment. Input Data: Input Description Example FastQ files (e.g. SRR9666131.sra.fastq,SRR9666132.sra.fastq...) Sequencing data in FastQ format SRA FastQ Files","title":"Apply Metadata to FastQ Files"},{"location":"step6/#apply-metadata","text":"In a spreadsheet program (e.g., Excel), open the SraRunTable.txt file on your local computer. Tip Renaming the file with a '.csv' extension before opening the file may make it easier for your spreadsheet program to properly interpret. To the spreadsheet, add a new first column (left-most). Name this column \" file .\" At this point, sort the spreadsheet by run (ascending). This will make it easier in the subsequent steps when file names will likely be alphanumerically sorted. In the file column we will list the path in the Data Store for each FASTQ file as corresponds to its accession in the Run column. (e.g., /iplant/home/ USERNAME /rna-seq-tutorial/fastq_files/ SRR9666132.sra.fastq). In the Data view, clicking the three dots next to any file/folder icon reveals a function menu which includes an option to Copy Path . Note Your first two columns should be similar to the below (with your username replacing username below): File Run /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666131.sra.fastq SRR9666131 /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666132.sra.fastq SRR9666132 /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666133.sra.fastq SRR9666133 /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666134.sra.fastq SRR9666134 /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666135.sra.fastq SRR9666135 /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666136.sra.fastq SRR9666136 /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666137.sra.fastq SRR9666137 /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666138.sra.fastq SRR9666138 /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666139.sra.fastq SRR9666139 /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666140.sra.fastq SRR9666140 /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666141.sra.fastq SRR9666141 /iplant/home/username/rna-seq-tutorial/fastq_files/SRR9666142.sra.fastq SRR9666142 5. (Optional) At this point, you can add any desired additional columns with any metadata you want to add. For our tutorial this is not necessary. 6. Save this file as fastq_file_metadata.csv on your local computer. 7. In the Discovery Environment Data view, navigate to the metadata folder in your rna-seq-tutorial folder. Open the folder and then click the Upload button, then select Browse Local . 8. Browse your local computer to select the fastq_file_metadata.csv ; upload the file. You will get a notification when upload is completed. You may need to refresh your browser to see the uploaded file. 9. In the Data view, navigate to your rna-seq-tutorial folder and select (checkbox) the fastq_files folder. 10. Click the More Actions button and select Apply Bulk Metadata . Browse to and select the fastq_file_metadata.csv file in the metadata folder. Click Done to complete this action. You will get a notification when the metadata has been applied successfully. 11. To view the metadata, navigate to the fastq_files folder and select (checkbox) any individual FASTQ file. Click the More Actions button and select Metadata . You will then see the applied metadata. You can build custom search queries on any of these attributes (column names in your original spreadsheet) and the values (the entries for these columns). See Data Store Guide for more information about advanced search queries and smart folders. Output/Results Output Description Example fastq_file_metadata.csv A CSV file containing metadata labels for the FastQ files FastQ metadata Description of output and results With metadata applied, this files are now more easy to search and organize. These metadata properties will also be of use in data submission to repositories like SRA.","title":"Apply Metadata"},{"location":"step7/","text":"QC Reads with FastQC \u00b6 Description: We will do a quality check to verify the sequencing data is of suitable quality for downstream analysis. Input Data: Input Description Example fastq_file_metadata.csv A CSV file containing metadata labels for the FastQ files FastQ metadata Use FastQC App to Report on Sequence Quality \u00b6 In the Discovery Environment click on the Data icon and navigate to your rna-seq-tutorial tutorial folder and create a folder to store outputs, name the folder fastqc_analyses . In the Apps view, search for and launch the FastQC 0.11.5 (multi-file) app. You can use this direct link: FastQC app In Analysis Info you can name this analysis and provide any comments (optional). Under Output folder , navigate to the fastqc_analyses folder created earlier. Your outputs will automatically be placed in this folder; click Next . In Parameters for Input browse to the fastq_files folder previously created and add the 12 files (e.g., SRR9666131.sra.fastq, SRR9666132.sra.fastq); click Next . Click Next again to skip Advanced Settings (optional) ; under Review and Launch click Launch Analysis . Click on Analyses view to see the current status of the job; you can also click on the Analyses icon to navigate to this section. When the job is complete, you can click on the folder icon next to the analyses name to browse the results. You may need to Refresh to see the current job status. This job is expected to take 30-40 minutes. When the job has status Completed , navigate to the output. The expected output will be 12 HTML formatted reports, and 12 zip files containing additional files including text-based metrics. You can click on and examine all the HTML files; they will open as new tabs in your web browser. Review of the example dataset indicates the samples are all of high quality and additional filtering or trimming would not improve our quantification results. Output/Results Output Description Example HTML and ZIP files of FastQC reports For each FastQ file an HTML file with an interactive report on sequence quality and a ZIP file with components of that report are created. FastQC Reports Description of output and results In the case of the tutorial data, the sequence quality is of very high quality. If necessary, other applications (e.g. Trimmomatic) could be used at this stage to do further filtering or trimming.","title":"Step 7"},{"location":"step7/#qc-reads-with-fastqc","text":"Description: We will do a quality check to verify the sequencing data is of suitable quality for downstream analysis. Input Data: Input Description Example fastq_file_metadata.csv A CSV file containing metadata labels for the FastQ files FastQ metadata","title":"QC Reads with FastQC"},{"location":"step7/#use-fastqc-app-to-report-on-sequence-quality","text":"In the Discovery Environment click on the Data icon and navigate to your rna-seq-tutorial tutorial folder and create a folder to store outputs, name the folder fastqc_analyses . In the Apps view, search for and launch the FastQC 0.11.5 (multi-file) app. You can use this direct link: FastQC app In Analysis Info you can name this analysis and provide any comments (optional). Under Output folder , navigate to the fastqc_analyses folder created earlier. Your outputs will automatically be placed in this folder; click Next . In Parameters for Input browse to the fastq_files folder previously created and add the 12 files (e.g., SRR9666131.sra.fastq, SRR9666132.sra.fastq); click Next . Click Next again to skip Advanced Settings (optional) ; under Review and Launch click Launch Analysis . Click on Analyses view to see the current status of the job; you can also click on the Analyses icon to navigate to this section. When the job is complete, you can click on the folder icon next to the analyses name to browse the results. You may need to Refresh to see the current job status. This job is expected to take 30-40 minutes. When the job has status Completed , navigate to the output. The expected output will be 12 HTML formatted reports, and 12 zip files containing additional files including text-based metrics. You can click on and examine all the HTML files; they will open as new tabs in your web browser. Review of the example dataset indicates the samples are all of high quality and additional filtering or trimming would not improve our quantification results. Output/Results Output Description Example HTML and ZIP files of FastQC reports For each FastQ file an HTML file with an interactive report on sequence quality and a ZIP file with components of that report are created. FastQC Reports Description of output and results In the case of the tutorial data, the sequence quality is of very high quality. If necessary, other applications (e.g. Trimmomatic) could be used at this stage to do further filtering or trimming.","title":"Use FastQC App to Report on Sequence Quality"},{"location":"step8/","text":"Quantify Reads with Kallisto \u00b6 Description: Kallisto will individually generate pseudoalignments and quantification for each replicate of each condition. In the Discovery Environment application, the 'Kallisto index' command will first build an index of the transcriptome. Next, that indexed transcriptome will be used to quantify the read data (equivalent to the 'Kallisto quant' command at the command line). Input Data: Input Description Example Transcriptiome A transcriptome for pseudoalignment is required Arabidopsis transcriptome FastQ files (e.g. SRR9666131.sra.fastq,SRR9666132.sra.fastq...) Sequencing data in FastQ format SRA FastQ Files Import Transcriptome from Ensembl \u00b6 Go to the Ensembl homepage for Arabidopsis at https://plants.ensembl.org/Arabidopsis_thaliana/Info/Index . Under Gene annotation click the FASTA link under 'Download genes, cDNAs, ncRNA, proteins' ; ftp://ftp.ensemblgenomes.org/pub/plants/release-48/fasta/arabidopsis_thaliana . In the cnda folder, locate the file Arabidopsis_thaliana.TAIR10.cdna.all.fa.gz . In your web browser, copy the URL for this file (left click, Copy Link Location for most browsers). The URL for release 48 of Ensembl is ftp://ftp.ensemblgenomes.org/pub/plants/release-48/fasta/arabidopsis_thaliana/cdna/Arabidopsis_thaliana.TAIR10.cdna.all.fa.gz . Tip Ensure you use the 'cdna.all.fa.gz'; your annotation release must match what is used later in the Sleuth analysis In the Data view in the Discovery Environment , navigate to your rna-seq-tutorial folder. Create a new folder called transcriptome and navigate into the newly created folder. In the Data view, click the Upload button and choose Import from URL ; paste in the URL for the Arabidopsis transcriptome. Be sure to avoid any extra spaces or characters at the end of your URL. Click Import to complete this action. You will get a notification when import is complete. You may need to refresh your browser to see the imported file. Back on the Ensembl page, also copy the URL for the CHECKSUMS file and repeat the import procedure to the same folder. Tip You can also apply metadata to the imported transcriptome. See also the for Data Store Guide additional options for apply metadata. Use Kallisto App to Psuedoalign Reads \u00b6 Click on the Data icon and navigate to your rna-seq-tutorial tutorial folder and create a folder to store outputs, name the folder kallisto_analyses . In the Apps view, search for and launch the Kallisto-v.0.43.1 app. In Analysis Info you can name this analysis and provide any comments (optional). Under Output folder , navigate to the kallisto_analyses folder created earlier. Your outputs will automatically be placed in this folder; click Next . In Parameters under Input : (a) For The transcript fasta file supplied (fasta or gzipped) browse to the transcriptome folder and add the Arabidopsis_thaliana.TAIR10.cdna.all.fa.gz file. (b) For Paired or single end choose single. \u00a9 Under FASTQ Files (Read1) : Click Browse and browse to the fastq_files folder and select 12 files (e.g., SRR9666131.sra.fastq, SRR9666132.sra.fastq...). Under Options (a) For Number of bootstrap samples enter 25. (b) For Estimated average fragment length (required for single end reads) enter 200. \u00a9 For Estimated standard deviation of fragment length (required for single end reads) enter 20.; Note Although SRA data usually does not contain fragment length and standard deviation, these are common values. For other options for this application, consult the Kallisto documentation . Bootstrapping is the most computationally intensive option, so higher numbers of bootstrapping operations will cause the analysis to take longer to complete. Click Next . Click Next again to skip Advanced Settings (optional) ; under Review and Launch click Launch Analysis . Click on Analyses view to see the current status of the job; you can also click on the Analyses icon to navigate to this section. When the job is complete, you can click on the folder icon next to the analyses name to browse the results. You may need to Refresh to see the current job status. This job is estimated to take about 60-70 minutes. When the job has status Completed to navigate to the expected output. The expected output will be a folder Kallisto_quant_output containing 12 folders (labeled with the accession name). Output/Results Output Description Example Kallisto quantification results (abundances.h5, abundances.tsv, run_info.json for each FastQ file analyzed ) See detailed description below Kallisto outputs Description of output and results Kallisto will generate a set of results for each FastQ file (or pairs of FastQ files if our data were paired-end sequenced). Inside each folder will be: abundances.h5 : HDF5 binary file containing run info, abundance estimates, bootstrap estimates, and transcript length information length. This file can be read in by Sleuth. abundances.tsv : plaintext file of the abundance estimates. It does not contain bootstrap estimates. When plaintext mode is selected; output plaintext abundance estimates. Alternatively, Kallisto h5dump will output an HDF5 file to plaintext. The first line contains a header for each column, including estimated counts, TPM, effective length. run_info.json : a json file containing information about the run. Note We did not select the BAM file creation option when launching the app. Although a BAM file will be created, it is empty and can be ignored.","title":"Step 8"},{"location":"step8/#quantify-reads-with-kallisto","text":"Description: Kallisto will individually generate pseudoalignments and quantification for each replicate of each condition. In the Discovery Environment application, the 'Kallisto index' command will first build an index of the transcriptome. Next, that indexed transcriptome will be used to quantify the read data (equivalent to the 'Kallisto quant' command at the command line). Input Data: Input Description Example Transcriptiome A transcriptome for pseudoalignment is required Arabidopsis transcriptome FastQ files (e.g. SRR9666131.sra.fastq,SRR9666132.sra.fastq...) Sequencing data in FastQ format SRA FastQ Files","title":"Quantify Reads with Kallisto"},{"location":"step8/#import-transcriptome-from-ensembl","text":"Go to the Ensembl homepage for Arabidopsis at https://plants.ensembl.org/Arabidopsis_thaliana/Info/Index . Under Gene annotation click the FASTA link under 'Download genes, cDNAs, ncRNA, proteins' ; ftp://ftp.ensemblgenomes.org/pub/plants/release-48/fasta/arabidopsis_thaliana . In the cnda folder, locate the file Arabidopsis_thaliana.TAIR10.cdna.all.fa.gz . In your web browser, copy the URL for this file (left click, Copy Link Location for most browsers). The URL for release 48 of Ensembl is ftp://ftp.ensemblgenomes.org/pub/plants/release-48/fasta/arabidopsis_thaliana/cdna/Arabidopsis_thaliana.TAIR10.cdna.all.fa.gz . Tip Ensure you use the 'cdna.all.fa.gz'; your annotation release must match what is used later in the Sleuth analysis In the Data view in the Discovery Environment , navigate to your rna-seq-tutorial folder. Create a new folder called transcriptome and navigate into the newly created folder. In the Data view, click the Upload button and choose Import from URL ; paste in the URL for the Arabidopsis transcriptome. Be sure to avoid any extra spaces or characters at the end of your URL. Click Import to complete this action. You will get a notification when import is complete. You may need to refresh your browser to see the imported file. Back on the Ensembl page, also copy the URL for the CHECKSUMS file and repeat the import procedure to the same folder. Tip You can also apply metadata to the imported transcriptome. See also the for Data Store Guide additional options for apply metadata.","title":"Import Transcriptome from Ensembl"},{"location":"step8/#use-kallisto-app-to-psuedoalign-reads","text":"Click on the Data icon and navigate to your rna-seq-tutorial tutorial folder and create a folder to store outputs, name the folder kallisto_analyses . In the Apps view, search for and launch the Kallisto-v.0.43.1 app. In Analysis Info you can name this analysis and provide any comments (optional). Under Output folder , navigate to the kallisto_analyses folder created earlier. Your outputs will automatically be placed in this folder; click Next . In Parameters under Input : (a) For The transcript fasta file supplied (fasta or gzipped) browse to the transcriptome folder and add the Arabidopsis_thaliana.TAIR10.cdna.all.fa.gz file. (b) For Paired or single end choose single. \u00a9 Under FASTQ Files (Read1) : Click Browse and browse to the fastq_files folder and select 12 files (e.g., SRR9666131.sra.fastq, SRR9666132.sra.fastq...). Under Options (a) For Number of bootstrap samples enter 25. (b) For Estimated average fragment length (required for single end reads) enter 200. \u00a9 For Estimated standard deviation of fragment length (required for single end reads) enter 20.; Note Although SRA data usually does not contain fragment length and standard deviation, these are common values. For other options for this application, consult the Kallisto documentation . Bootstrapping is the most computationally intensive option, so higher numbers of bootstrapping operations will cause the analysis to take longer to complete. Click Next . Click Next again to skip Advanced Settings (optional) ; under Review and Launch click Launch Analysis . Click on Analyses view to see the current status of the job; you can also click on the Analyses icon to navigate to this section. When the job is complete, you can click on the folder icon next to the analyses name to browse the results. You may need to Refresh to see the current job status. This job is estimated to take about 60-70 minutes. When the job has status Completed to navigate to the expected output. The expected output will be a folder Kallisto_quant_output containing 12 folders (labeled with the accession name). Output/Results Output Description Example Kallisto quantification results (abundances.h5, abundances.tsv, run_info.json for each FastQ file analyzed ) See detailed description below Kallisto outputs Description of output and results Kallisto will generate a set of results for each FastQ file (or pairs of FastQ files if our data were paired-end sequenced). Inside each folder will be: abundances.h5 : HDF5 binary file containing run info, abundance estimates, bootstrap estimates, and transcript length information length. This file can be read in by Sleuth. abundances.tsv : plaintext file of the abundance estimates. It does not contain bootstrap estimates. When plaintext mode is selected; output plaintext abundance estimates. Alternatively, Kallisto h5dump will output an HDF5 file to plaintext. The first line contains a header for each column, including estimated counts, TPM, effective length. run_info.json : a json file containing information about the run. Note We did not select the BAM file creation option when launching the app. Although a BAM file will be created, it is empty and can be ignored.","title":"Use Kallisto App to Psuedoalign Reads"},{"location":"step9/","text":"Prepare Experimental Design Metadata for Sleuth \u00b6 Description: Before we use Sleuth to analyze our data, we need to create a tab-delimited file that matches our samples to their conditions. It is convenient to do this on your local computer, using a spreadsheet program. We can easily modify the SraRunTable.txt file we downloaded from the SRA. Input Data: Input Description Example Metadata from the SRA Metadata that describes our dataset; will be modified to appropriately indicate experimental variables and controls. SraRunTable Create Experimental Design Table \u00b6 1. In your spreadsheet program, open SraRunTable.txt (downloaded previously from SRA). 2. According to the Sleuth instructions, the first column must be named ' sample '; rename the Run column to sample . 3. Next, you will want to create new columns which specify attributes about each sample such as what treatment/condition correspond to each sample. In the table below, we suggest columns that indicate the condition (e.g., control, NAA treated, high-melatonin, low-melatonin), replicate numbers, etc. See the example experimental design file for the example of the file to create. 4. Save the experimental design file in TSV format (e.g. experimental_design.tsv ). 5. In the Discovery Environment , navigate to the metadata folder you created for this experiment ( rna-seq-tutorial/metadata ). Click the Upload button and select Browse Local . 6. Browse your local computer to select the experimental design file (i.e., experimental_design.tsv ) and upload the file. You will get a notification when upload is completed. You may need to refresh your browser to see the uploaded file. Output/Results Output Description Example experimental_design.tsv A TSV file describing how each sample relates to an experimental condition and/or metadata variable. Example experimental design Description of output and results The TSV file created links the name of the sample (in our case synonymous with SRA accession numbers) to the experimental design (e.g. conditions, controls, and other metadata).","title":"Step 9"},{"location":"step9/#prepare-experimental-design-metadata-for-sleuth","text":"Description: Before we use Sleuth to analyze our data, we need to create a tab-delimited file that matches our samples to their conditions. It is convenient to do this on your local computer, using a spreadsheet program. We can easily modify the SraRunTable.txt file we downloaded from the SRA. Input Data: Input Description Example Metadata from the SRA Metadata that describes our dataset; will be modified to appropriately indicate experimental variables and controls. SraRunTable","title":"Prepare Experimental Design Metadata for Sleuth"},{"location":"step9/#create-experimental-design-table","text":"1. In your spreadsheet program, open SraRunTable.txt (downloaded previously from SRA). 2. According to the Sleuth instructions, the first column must be named ' sample '; rename the Run column to sample . 3. Next, you will want to create new columns which specify attributes about each sample such as what treatment/condition correspond to each sample. In the table below, we suggest columns that indicate the condition (e.g., control, NAA treated, high-melatonin, low-melatonin), replicate numbers, etc. See the example experimental design file for the example of the file to create. 4. Save the experimental design file in TSV format (e.g. experimental_design.tsv ). 5. In the Discovery Environment , navigate to the metadata folder you created for this experiment ( rna-seq-tutorial/metadata ). Click the Upload button and select Browse Local . 6. Browse your local computer to select the experimental design file (i.e., experimental_design.tsv ) and upload the file. You will get a notification when upload is completed. You may need to refresh your browser to see the uploaded file. Output/Results Output Description Example experimental_design.tsv A TSV file describing how each sample relates to an experimental condition and/or metadata variable. Example experimental design Description of output and results The TSV file created links the name of the sample (in our case synonymous with SRA accession numbers) to the experimental design (e.g. conditions, controls, and other metadata).","title":"Create Experimental Design Table"}]}